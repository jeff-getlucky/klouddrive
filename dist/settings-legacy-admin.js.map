{"version":3,"file":"settings-legacy-admin.js?v=aa4a777a434ee374ec83","mappings":";;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AEpPA;AACA;AACA;AACA;AACA","sources":["webpack:///nextcloud/apps/settings/src/admin.js","webpack:///nextcloud/webpack/before-startup","webpack:///nextcloud/webpack/startup","webpack:///nextcloud/webpack/after-startup"],"sourcesContent":["window.addEventListener('DOMContentLoaded', () => {\n  $('#excludedGroups,#linksExcludedGroups,#passwordsExcludedGroups').each(function (index, element) {\n    OC.Settings.setupGroupsSelect($(element));\n    $(element).change(function (ev) {\n      let groups = ev.val || [];\n      groups = JSON.stringify(groups);\n      OCP.AppConfig.setValue('core', $(this).attr('name'), groups);\n    });\n  });\n  $('#loglevel').change(function () {\n    $.post(OC.generateUrl('/settings/admin/log/level'), {\n      level: $(this).val()\n    }, () => {\n      OC.Log.reload();\n    });\n  });\n  $('#shareAPIEnabled').change(function () {\n    $('#shareAPI p:not(#enable)').toggleClass('hidden', !this.checked);\n  });\n  $('#shareapiExpireAfterNDays').on('input', function () {\n    this.value = this.value.replace(/\\D/g, '');\n  });\n  $('#shareAPI input:not(.noJSAutoUpdate)').change(function () {\n    let value = $(this).val();\n    if ($(this).attr('type') === 'checkbox') {\n      if (this.checked) {\n        value = 'yes';\n      } else {\n        value = 'no';\n      }\n    }\n    OCP.AppConfig.setValue('core', $(this).attr('name'), value);\n  });\n  $('#shareapiDefaultExpireDate').change(function () {\n    $('#setDefaultExpireDate').toggleClass('hidden', !this.checked);\n  });\n  $('#shareapiDefaultInternalExpireDate').change(function () {\n    $('#setDefaultInternalExpireDate').toggleClass('hidden', !this.checked);\n  });\n  $('#shareapiDefaultRemoteExpireDate').change(function () {\n    $('#setDefaultRemoteExpireDate').toggleClass('hidden', !this.checked);\n  });\n  $('#enforceLinkPassword').change(function () {\n    $('#selectPasswordsExcludedGroups').toggleClass('hidden', !this.checked);\n  });\n  $('#publicShareDisclaimer').change(function () {\n    $('#publicShareDisclaimerText').toggleClass('hidden', !this.checked);\n    if (!this.checked) {\n      savePublicShareDisclaimerText('');\n    }\n  });\n  $('#shareApiDefaultPermissionsSection input').change(function (ev) {\n    const $el = $('#shareApiDefaultPermissions');\n    const $target = $(ev.target);\n    let value = $el.val();\n    if ($target.is(':checked')) {\n      value = value | $target.val();\n    } else {\n      value = value & ~$target.val();\n    }\n\n    // always set read permission\n    value |= OC.PERMISSION_READ;\n\n    // this will trigger the field's change event and will save it\n    $el.val(value).change();\n    ev.preventDefault();\n    return false;\n  });\n  const savePublicShareDisclaimerText = _.debounce(function (value) {\n    const options = {\n      success: () => {\n        OC.msg.finishedSuccess('#publicShareDisclaimerStatus', t('settings', 'Saved'));\n      },\n      error: () => {\n        OC.msg.finishedError('#publicShareDisclaimerStatus', t('settings', 'Not saved'));\n      }\n    };\n    OC.msg.startSaving('#publicShareDisclaimerStatus');\n    if (_.isString(value) && value !== '') {\n      OCP.AppConfig.setValue('core', 'shareapi_public_link_disclaimertext', value, options);\n    } else {\n      $('#publicShareDisclaimerText').val('');\n      OCP.AppConfig.deleteKey('core', 'shareapi_public_link_disclaimertext', options);\n    }\n  }, 500);\n  $('#publicShareDisclaimerText').on('change, keyup', function () {\n    savePublicShareDisclaimerText(this.value);\n  });\n  $('#shareapi_allow_share_dialog_user_enumeration').on('change', function () {\n    $('#shareapi_restrict_user_enumeration_to_group_setting').toggleClass('hidden', !this.checked);\n    $('#shareapi_restrict_user_enumeration_to_phone_setting').toggleClass('hidden', !this.checked);\n    $('#shareapi_restrict_user_enumeration_combinewarning_setting').toggleClass('hidden', !this.checked);\n  });\n  $('#allowLinks').change(function () {\n    $('#publicLinkSettings').toggleClass('hidden', !this.checked);\n    $('#setDefaultExpireDate').toggleClass('hidden', !(this.checked && $('#shareapiDefaultExpireDate')[0].checked));\n  });\n  $('#mail_smtpauth').change(function () {\n    if (!this.checked) {\n      $('#mail_credentials').addClass('hidden');\n    } else {\n      $('#mail_credentials').removeClass('hidden');\n    }\n  });\n  $('#mail_smtpmode').change(function () {\n    if ($(this).val() !== 'smtp') {\n      $('#setting_smtpauth').addClass('hidden');\n      $('#setting_smtphost').addClass('hidden');\n      $('#mail_smtpsecure_label').addClass('hidden');\n      $('#mail_smtpsecure').addClass('hidden');\n      $('#mail_credentials').addClass('hidden');\n      $('#mail_sendmailmode_label, #mail_sendmailmode').removeClass('hidden');\n    } else {\n      $('#setting_smtpauth').removeClass('hidden');\n      $('#setting_smtphost').removeClass('hidden');\n      $('#mail_smtpsecure_label').removeClass('hidden');\n      $('#mail_smtpsecure').removeClass('hidden');\n      if ($('#mail_smtpauth').is(':checked')) {\n        $('#mail_credentials').removeClass('hidden');\n      }\n      $('#mail_sendmailmode_label, #mail_sendmailmode').addClass('hidden');\n    }\n  });\n  const changeEmailSettings = function () {\n    if (OC.PasswordConfirmation.requiresPasswordConfirmation()) {\n      OC.PasswordConfirmation.requirePasswordConfirmation(changeEmailSettings);\n      return;\n    }\n    OC.msg.startSaving('#mail_settings_msg');\n    $.ajax({\n      url: OC.generateUrl('/settings/admin/mailsettings'),\n      type: 'POST',\n      data: $('#mail_general_settings_form').serialize(),\n      success: () => {\n        OC.msg.finishedSuccess('#mail_settings_msg', t('settings', 'Saved'));\n      },\n      error: xhr => {\n        OC.msg.finishedError('#mail_settings_msg', xhr.responseJSON);\n      }\n    });\n  };\n  const toggleEmailCredentials = function () {\n    if (OC.PasswordConfirmation.requiresPasswordConfirmation()) {\n      OC.PasswordConfirmation.requirePasswordConfirmation(toggleEmailCredentials);\n      return;\n    }\n    OC.msg.startSaving('#mail_settings_msg');\n    $.ajax({\n      url: OC.generateUrl('/settings/admin/mailsettings/credentials'),\n      type: 'POST',\n      data: $('#mail_credentials_settings').serialize(),\n      success: () => {\n        OC.msg.finishedSuccess('#mail_settings_msg', t('settings', 'Saved'));\n      },\n      error: xhr => {\n        OC.msg.finishedError('#mail_settings_msg', xhr.responseJSON);\n      }\n    });\n  };\n  $('#mail_general_settings_form').change(changeEmailSettings);\n  $('#mail_credentials_settings_submit').click(toggleEmailCredentials);\n  $('#mail_smtppassword').click(() => {\n    if (this.type === 'text' && this.value === '********') {\n      this.type = 'password';\n      this.value = '';\n    }\n  });\n  $('#sendtestemail').click(event => {\n    event.preventDefault();\n    OC.msg.startAction('#sendtestmail_msg', t('settings', 'Sendingâ€¦'));\n    $.ajax({\n      url: OC.generateUrl('/settings/admin/mailtest'),\n      type: 'POST',\n      success: () => {\n        OC.msg.finishedSuccess('#sendtestmail_msg', t('settings', 'Email sent'));\n      },\n      error: xhr => {\n        OC.msg.finishedError('#sendtestmail_msg', xhr.responseJSON);\n      }\n    });\n  });\n  $('#allowGroupSharing').change(function () {\n    $('#allowGroupSharing').toggleClass('hidden', !this.checked);\n  });\n  $('#shareapiExcludeGroups').change(function () {\n    $('#selectExcludedGroups').toggleClass('hidden', !this.checked);\n  });\n  const setupChecks = () => {\n    // run setup checks then gather error messages\n    $.when(OC.SetupChecks.checkWebDAV(), OC.SetupChecks.checkWellKnownUrl('GET', '/.well-known/webfinger', OC.theme.docPlaceholderUrl, $('#postsetupchecks').data('check-wellknown') === true, [200, 404], true), OC.SetupChecks.checkWellKnownUrl('GET', '/.well-known/nodeinfo', OC.theme.docPlaceholderUrl, $('#postsetupchecks').data('check-wellknown') === true, [200, 404], true), OC.SetupChecks.checkWellKnownUrl('PROPFIND', '/.well-known/caldav', OC.theme.docPlaceholderUrl, $('#postsetupchecks').data('check-wellknown') === true), OC.SetupChecks.checkWellKnownUrl('PROPFIND', '/.well-known/carddav', OC.theme.docPlaceholderUrl, $('#postsetupchecks').data('check-wellknown') === true), OC.SetupChecks.checkProviderUrl(OC.getRootPath() + '/ocm-provider/', OC.theme.docPlaceholderUrl, $('#postsetupchecks').data('check-wellknown') === true), OC.SetupChecks.checkProviderUrl(OC.getRootPath() + '/ocs-provider/', OC.theme.docPlaceholderUrl, $('#postsetupchecks').data('check-wellknown') === true), OC.SetupChecks.checkSetup(), OC.SetupChecks.checkGeneric(), OC.SetupChecks.checkWOFF2Loading(OC.filePath('core', '', 'fonts/NotoSans-Regular-latin.woff2'), OC.theme.docPlaceholderUrl), OC.SetupChecks.checkDataProtected()).then((check1, check2, check3, check4, check5, check6, check7, check8, check9, check10, check11) => {\n      const messages = [].concat(check1, check2, check3, check4, check5, check6, check7, check8, check9, check10, check11);\n      const $el = $('#postsetupchecks');\n      $('#security-warning-state-loading').addClass('hidden');\n      let hasMessages = false;\n      const $errorsEl = $el.find('.errors');\n      const $warningsEl = $el.find('.warnings');\n      const $infoEl = $el.find('.info');\n      for (let i = 0; i < messages.length; i++) {\n        switch (messages[i].type) {\n          case OC.SetupChecks.MESSAGE_TYPE_INFO:\n            $infoEl.append('<li>' + messages[i].msg + '</li>');\n            break;\n          case OC.SetupChecks.MESSAGE_TYPE_WARNING:\n            $warningsEl.append('<li>' + messages[i].msg + '</li>');\n            break;\n          case OC.SetupChecks.MESSAGE_TYPE_ERROR:\n          default:\n            $errorsEl.append('<li>' + messages[i].msg + '</li>');\n        }\n      }\n      if ($errorsEl.find('li').length > 0) {\n        $errorsEl.removeClass('hidden');\n        hasMessages = true;\n      }\n      if ($warningsEl.find('li').length > 0) {\n        $warningsEl.removeClass('hidden');\n        hasMessages = true;\n      }\n      if ($infoEl.find('li').length > 0) {\n        $infoEl.removeClass('hidden');\n        hasMessages = true;\n      }\n      if (hasMessages) {\n        $('#postsetupchecks-hint').removeClass('hidden');\n        if ($errorsEl.find('li').length > 0) {\n          $('#security-warning-state-failure').removeClass('hidden');\n        } else {\n          $('#security-warning-state-warning').removeClass('hidden');\n        }\n      } else {\n        const securityWarning = $('#security-warning');\n        if (securityWarning.children('ul').children().length === 0) {\n          $('#security-warning-state-ok').removeClass('hidden');\n        } else {\n          $('#security-warning-state-failure').removeClass('hidden');\n        }\n      }\n    });\n  };\n  if (document.getElementById('security-warning') !== null) {\n    setupChecks();\n  }\n  $('#shareAPI').removeClass('loading');\n});","","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = {};\n__webpack_modules__[\"./apps/settings/src/admin.js\"]();\n",""],"names":[],"sourceRoot":""}